<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Lee Durbin">
<title>Getting Started With R: Final Assignment</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="final_assignment_files/libs/clipboard/clipboard.min.js"></script>
<script src="final_assignment_files/libs/quarto-html/quarto.js"></script>
<script src="final_assignment_files/libs/quarto-html/popper.min.js"></script>
<script src="final_assignment_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="final_assignment_files/libs/quarto-html/anchor.min.js"></script>
<link href="final_assignment_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="final_assignment_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="final_assignment_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="final_assignment_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="final_assignment_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script src="final_assignment_files/libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="final_assignment_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="final_assignment_files/libs/datatables-binding-0.26/datatables.js"></script><script src="final_assignment_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><link href="final_assignment_files/libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="final_assignment_files/libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="final_assignment_files/libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script><link href="final_assignment_files/libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="final_assignment_files/libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
</head>
<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#load-the-packages-peek-at-the-data" id="toc-load-the-packages-peek-at-the-data" class="nav-link active" data-scroll-target="#load-the-packages-peek-at-the-data">Load the packages, peek at the data</a></li>
  <li><a href="#pivot-fix-excel-dates" id="toc-pivot-fix-excel-dates" class="nav-link" data-scroll-target="#pivot-fix-excel-dates">Pivot &amp; fix Excel dates</a></li>
  <li><a href="#cleaning-string-values" id="toc-cleaning-string-values" class="nav-link" data-scroll-target="#cleaning-string-values">Cleaning string values</a></li>
  <li><a href="#bringing-it-all-together" id="toc-bringing-it-all-together" class="nav-link" data-scroll-target="#bringing-it-all-together">Bringing it all together</a></li>
  <li><a href="#improve-it-with-iteration" id="toc-improve-it-with-iteration" class="nav-link" data-scroll-target="#improve-it-with-iteration">Improve it with iteration</a></li>
  <li><a href="#whats-the-most-least-popular-social-media-platform" id="toc-whats-the-most-least-popular-social-media-platform" class="nav-link" data-scroll-target="#whats-the-most-least-popular-social-media-platform">What’s the most &amp; least popular social media platform?</a></li>
  <li><a href="#what-are-the-peak-months-for-each-platform" id="toc-what-are-the-peak-months-for-each-platform" class="nav-link" data-scroll-target="#what-are-the-peak-months-for-each-platform">What are the “peak” months for each platform?</a></li>
  </ul></nav>
</div>
<main class="content column-page-left" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Getting Started With R: Final Assignment</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Lee Durbin </p>
          </div>
  </div>
    
    
  </div>
  

</header><section id="load-the-packages-peek-at-the-data" class="level2"><h2 class="anchored" data-anchor-id="load-the-packages-peek-at-the-data">Load the packages, peek at the data</h2>
<p>In this tutorial we’re going to prepare and analyse social media stats for Auckland Libraries. The tutorial was written using Quarto, and code linking has been enabled so that you can click on the functions in the code chunks below to learn more about them.</p>
<p>Before we begin, let’s install and load five packages we’ll need for preparing the data: readxl, dplyr, tidyr, janitor, and stringr. We’re also installing DT, purely for the sake of presenting the data within this guide.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># install.packages("readxl")</span></span>
<span><span class="co"># install.packages("dplyr")</span></span>
<span><span class="co"># install.packages("tidyr")</span></span>
<span><span class="co"># install.packages("janitor")</span></span>
<span><span class="co"># install.packages("stringr")</span></span>
<span><span class="co"># install.packages("DT")</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT">DT</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now let’s inspect our Excel file. How many sheets does it have?</p>
<p>I’m using the fs package here to grab the Excel file path without having to type out the filename, and passing that to excel_sheets() from the readxl package to return the names of the sheets. You don’t have to do this, but it is convenient.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">excel_file</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html">dir_ls</a></span><span class="op">(</span>glob <span class="op">=</span> <span class="st">"*.xlsx"</span><span class="op">)</span></span>
<span><span class="va">sheets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/excel_sheets.html">excel_sheets</a></span><span class="op">(</span><span class="va">excel_file</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sheets</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020 2021" "2021 2022" "2022 2023"</code></pre>
</div>
</div>
<p>So there are three Excel sheets in this file, one sheet per Financial Year. Let’s inspect one of those sheets, the first by default when we read the file:</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">first_sheet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">excel_file</span><span class="op">)</span></span>
<span></span>
<span><span class="va">first_sheet</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 33
Columns: 15
$ ...1    &lt;chr&gt; "Facebook posts", "Facebook reach (total)", "Facebook paid rea…
$ `44013` &lt;dbl&gt; 43, 44134, 1485, 1229, 786, 11, 19, 20654, 0, 2743, 3971, 45, …
$ `44044` &lt;dbl&gt; 40, 85255, 0, 2303, 1475, 11, 15, 18204, 0, 1097, 4579, 36, 50…
$ `44075` &lt;dbl&gt; 40, 147762, 0, 3536, 2443, 14, 28, 16783, 0, 1107, 5764, 40, 3…
$ `44105` &lt;dbl&gt; 44, 46530, 0, 735, 781, 17, 10, 18089, 0, 1168, 2480, 33, 3833…
$ `44136` &lt;dbl&gt; 30, 164833, 118202, 1446, 4118, 10, 17, 121463, 49695, 624, 55…
$ `44166` &lt;dbl&gt; 34, 91916, 59817, 3479, 18719, 9, 0, 140396, 68662, 579, 0, 40…
$ `44197` &lt;dbl&gt; 27, 62554, 45465, 1705, 31250, 10, 7, 171848, 81413, 716, 2262…
$ `44228` &lt;dbl&gt; 35, 55656, 12114, 2626, 3103, 12, 9, 48351, 22495, 754, 2636, …
$ `44256` &lt;dbl&gt; 43, 53156, 0, 1447, 1759, 10, 15, 14509, 0, 672, 6256, 59, 569…
$ `44287` &lt;dbl&gt; 26, 33144, 0, 702, 1193, 8, 5, 9379, 0, 522, 1932, 40, 47574, …
$ `44317` &lt;dbl&gt; 20, 136521, 115117, 4911, 11067, 8, 12, 178121, 70319, 466, 19…
$ `44348` &lt;dbl&gt; 27, 191509, 154593, 11010, 26303, 11, 4, 248750, 75299, 912, 3…
$ Total   &lt;dbl&gt; 409, 1112970, 506793, 35129, 102997, 131, 141, 1006547, 367883…
$ ...15   &lt;chr&gt; NA, NA, "* January 2021 stats may have been impacted by Facebo…</code></pre>
</div>
</div>
<p>Ok so this definitely isn’t tidy data, so there’s re-shaping we’ll need to do. I can also see numbers in many of the column headers, which are probably dates that Excel has converted to numbers.</p>
<p>Let’s take a peek at sheets two and three to confirm they follow a similar pattern:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">second_sheet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">excel_file</span>, sheet <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">second_sheet</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 38
Columns: 14
$ ...1    &lt;chr&gt; "Facebook posts (number of)", "Facebook paid reach", "Facebook…
$ `44378` &lt;dbl&gt; 7, 11663, 92265, 4730, 3800, 7, 0, 1, 33984, 0, 3555, 14445, 5…
$ `44409` &lt;dbl&gt; 14, 0, 61260, 3113, 6978, 11, 5, 5, 24220, 931, 13897, 0, 3904…
$ `44440` &lt;dbl&gt; 18, 0, 117794, 10837, 7939, 13, 18, 2, 19374, 3700, 7064, 0, 3…
$ `44470` &lt;dbl&gt; 7, 0, 70779, 4432, 14343, 7, 8, 1, 11177, 1630, 1366, 0, 14173…
$ `44501` &lt;dbl&gt; 11, 0, 65275, 3213, 3608, 9, 4, 1, 13556, 1147, 1307, 0, 16010…
$ `44531` &lt;dbl&gt; 15.00, 41933.00, 101675.00, 5746.00, 11630.00, 14.00, 5.00, 0.…
$ `44562` &lt;dbl&gt; 14.00, 19382.00, 72570.00, 2555.00, 3184.00, 13.00, 0.00, 0.00…
$ `44593` &lt;dbl&gt; 14, 0, 45472, 2071, 1692, 8, 17, 0, 7781, 5149, 0, 0, 12930, 5…
$ `44621` &lt;dbl&gt; 40, 306951, 380828, 7622, 30096, 23, 63, 0, 21982, 15854, 0, 5…
$ `44652` &lt;dbl&gt; 32, 299497, 353766, 4545, 14812, 23, 19, 0, 17401, 3470, 0, 52…
$ `44682` &lt;dbl&gt; 35, 43844, 103960, 5675, 21129, 22, 49, 0, 12849, 9657, 0, 0, …
$ `44713` &lt;dbl&gt; 36, 193748, 267623, 5674, 780, 25, 29, 0, 13158, 4993, 0, 1234…
$ Total   &lt;dbl&gt; 243.00, 917018.00, 1733267.00, 60213.00, 119991.00, 175.00, 21…</code></pre>
</div>
</div>
<p>Yep, same story with sheet two. What about three?</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">third_sheet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">excel_file</span>, sheet <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">third_sheet</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 38
Columns: 14
$ ...1    &lt;chr&gt; "Facebook posts (number of)", "Facebook paid reach", "Facebook…
$ `44743` &lt;dbl&gt; 41, 215914, 301862, 6520, 672, 23, 14, 0, 13723, 2968, 0, 4573…
$ `44774` &lt;dbl&gt; 74, 362673, 418194, 13587, 5869, 31, 60, 2, 22968, 3115, 3495,…
$ `44805` &lt;dbl&gt; 25, 13450, 48672, 2831, 4106, 17, 17, 0, 12200, 2534, 0, 0, 14…
$ `44835` &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `44866` &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `44896` &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `44927` &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `44958` &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `44986` &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `45017` &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `45047` &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `45078` &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ Total   &lt;dbl&gt; 140, 592037, 768728, 22938, 10647, 71, 91, 2, 48891, 8617, 349…</code></pre>
</div>
</div>
<p>Same thing here, albeit with more NAs because we don’t have a complete year of data for that one.</p>
<p>In conclusion, I have some data wrangling tasks to perform and those tasks are the same for each of the three sheets. Let’s fix up one of the sheets and take it from there.</p>
</section><section id="pivot-fix-excel-dates" class="level2"><h2 class="anchored" data-anchor-id="pivot-fix-excel-dates">Pivot &amp; fix Excel dates</h2>
<p>I know I want to re-shape the table from wide to long; having dates in the column headings, even when formatted as numbers, contravenes the tidy data convention. Let’s fix that by making use of tidyr’s pivot_longer function:</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">first_sheet_long</span> <span class="op">&lt;-</span> <span class="va">first_sheet</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">where</span><span class="op">(</span><span class="va">is.double</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">!=</span> <span class="st">"Total"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">date</span>, metric <span class="op">=</span> <span class="va">...1</span>, <span class="va">value</span><span class="op">)</span></span>
<span></span>
<span><span class="va">first_sheet_long</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-d09124dab7e6fc084741" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-d09124dab7e6fc084741">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396"],["44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348","44013","44044","44075","44105","44136","44166","44197","44228","44256","44287","44317","44348"],["Facebook posts","Facebook posts","Facebook posts","Facebook posts","Facebook posts","Facebook posts","Facebook posts","Facebook posts","Facebook posts","Facebook posts","Facebook posts","Facebook posts","Facebook reach (total)","Facebook reach (total)","Facebook reach (total)","Facebook reach (total)","Facebook reach (total)","Facebook reach (total)","Facebook reach (total)","Facebook reach (total)","Facebook reach (total)","Facebook reach (total)","Facebook reach (total)","Facebook reach (total)","Facebook paid reach","Facebook paid reach","Facebook paid reach","Facebook paid reach","Facebook paid reach","Facebook paid reach","Facebook paid reach","Facebook paid reach","Facebook paid reach","Facebook paid reach","Facebook paid reach","Facebook paid reach","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook video views","Facebook video views","Facebook video views","Facebook video views","Facebook video views","Facebook video views","Facebook video views","Facebook video views","Facebook video views","Facebook video views","Facebook video views","Facebook video views","Instagram posts","Instagram posts","Instagram posts","Instagram posts","Instagram posts","Instagram posts","Instagram posts","Instagram posts","Instagram posts","Instagram posts","Instagram posts","Instagram posts","Instagram stories","Instagram stories","Instagram stories","Instagram stories","Instagram stories","Instagram stories","Instagram stories","Instagram stories","Instagram stories","Instagram stories","Instagram stories","Instagram stories","Instagram reach (total)","Instagram reach (total)","Instagram reach (total)","Instagram reach (total)","Instagram reach (total)","Instagram reach (total)","Instagram reach (total)","Instagram reach (total)","Instagram reach (total)","Instagram reach (total)","Instagram reach (total)","Instagram reach (total)","Instagram paid reach","Instagram paid reach","Instagram paid reach","Instagram paid reach","Instagram paid reach","Instagram paid reach","Instagram paid reach","Instagram paid reach","Instagram paid reach","Instagram paid reach","Instagram paid reach","Instagram paid reach","Instagram engagement (likes, comments, saves and link clicks)","Instagram engagement (likes, comments, saves and link clicks)","Instagram engagement (likes, comments, saves and link clicks)","Instagram engagement (likes, comments, saves and link clicks)","Instagram engagement (likes, comments, saves and link clicks)","Instagram engagement (likes, comments, saves and link clicks)","Instagram engagement (likes, comments, saves and link clicks)","Instagram engagement (likes, comments, saves and link clicks)","Instagram engagement (likes, comments, saves and link clicks)","Instagram engagement (likes, comments, saves and link clicks)","Instagram engagement (likes, comments, saves and link clicks)","Instagram engagement (likes, comments, saves and link clicks)","Instagram Stories Reach","Instagram Stories Reach","Instagram Stories Reach","Instagram Stories Reach","Instagram Stories Reach","Instagram Stories Reach","Instagram Stories Reach","Instagram Stories Reach","Instagram Stories Reach","Instagram Stories Reach","Instagram Stories Reach","Instagram Stories Reach","Twitter posts","Twitter posts","Twitter posts","Twitter posts","Twitter posts","Twitter posts","Twitter posts","Twitter posts","Twitter posts","Twitter posts","Twitter posts","Twitter posts","Twitter impressions","Twitter impressions","Twitter impressions","Twitter impressions","Twitter impressions","Twitter impressions","Twitter impressions","Twitter impressions","Twitter impressions","Twitter impressions","Twitter impressions","Twitter impressions","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter video views","Twitter video views","Twitter video views","Twitter video views","Twitter video views","Twitter video views","Twitter video views","Twitter video views","Twitter video views","Twitter video views","Twitter video views","Twitter video views","Total social posts","Total social posts","Total social posts","Total social posts","Total social posts","Total social posts","Total social posts","Total social posts","Total social posts","Total social posts","Total social posts","Total social posts","Total social post reach","Total social post reach","Total social post reach","Total social post reach","Total social post reach","Total social post reach","Total social post reach","Total social post reach","Total social post reach","Total social post reach","Total social post reach","Total social post reach","Total social post engagement","Total social post engagement","Total social post engagement","Total social post engagement","Total social post engagement","Total social post engagement","Total social post engagement","Total social post engagement","Total social post engagement","Total social post engagement","Total social post engagement","Total social post engagement","Total video views (includes YouTube)","Total video views (includes YouTube)","Total video views (includes YouTube)","Total video views (includes YouTube)","Total video views (includes YouTube)","Total video views (includes YouTube)","Total video views (includes YouTube)","Total video views (includes YouTube)","Total video views (includes YouTube)","Total video views (includes YouTube)","Total video views (includes YouTube)","Total video views (includes YouTube)",null,null,null,null,null,null,null,null,null,null,null,null,"Facebook followers","Facebook followers","Facebook followers","Facebook followers","Facebook followers","Facebook followers","Facebook followers","Facebook followers","Facebook followers","Facebook followers","Facebook followers","Facebook followers","Instagram followers","Instagram followers","Instagram followers","Instagram followers","Instagram followers","Instagram followers","Instagram followers","Instagram followers","Instagram followers","Instagram followers","Instagram followers","Instagram followers","Twitter followers","Twitter followers","Twitter followers","Twitter followers","Twitter followers","Twitter followers","Twitter followers","Twitter followers","Twitter followers","Twitter followers","Twitter followers","Twitter followers","SoundCloud subscribers","SoundCloud subscribers","SoundCloud subscribers","SoundCloud subscribers","SoundCloud subscribers","SoundCloud subscribers","SoundCloud subscribers","SoundCloud subscribers","SoundCloud subscribers","SoundCloud subscribers","SoundCloud subscribers","SoundCloud subscribers",null,null,null,null,null,null,null,null,null,null,null,null,"Blog posts (Libraries + Heritage et AL)","Blog posts (Libraries + Heritage et AL)","Blog posts (Libraries + Heritage et AL)","Blog posts (Libraries + Heritage et AL)","Blog posts (Libraries + Heritage et AL)","Blog posts (Libraries + Heritage et AL)","Blog posts (Libraries + Heritage et AL)","Blog posts (Libraries + Heritage et AL)","Blog posts (Libraries + Heritage et AL)","Blog posts (Libraries + Heritage et AL)","Blog posts (Libraries + Heritage et AL)","Blog posts (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)",null,null,null,null,null,null,null,null,null,null,null,null,"YouTube views","YouTube views","YouTube views","YouTube views","YouTube views","YouTube views","YouTube views","YouTube views","YouTube views","YouTube views","YouTube views","YouTube views",null,null,null,null,null,null,null,null,null,null,null,null,"Sound Cloud podcasts","Sound Cloud podcasts","Sound Cloud podcasts","Sound Cloud podcasts","Sound Cloud podcasts","Sound Cloud podcasts","Sound Cloud podcasts","Sound Cloud podcasts","Sound Cloud podcasts","Sound Cloud podcasts","Sound Cloud podcasts","Sound Cloud podcasts","Sound Cloud podcast listens","Sound Cloud podcast listens","Sound Cloud podcast listens","Sound Cloud podcast listens","Sound Cloud podcast listens","Sound Cloud podcast listens","Sound Cloud podcast listens","Sound Cloud podcast listens","Sound Cloud podcast listens","Sound Cloud podcast listens","Sound Cloud podcast listens","Sound Cloud podcast listens"],[43,40,40,44,30,34,27,35,43,26,20,27,44134,85255,147762,46530,164833,91916,62554,55656,53156,33144,136521,191509,1485,0,0,0,118202,59817,45465,12114,0,0,115117,154593,1229,2303,3536,735,1446,3479,1705,2626,1447,702,4911,11010,786,1475,2443,781,4118,18719,31250,3103,1759,1193,11067,26303,11,11,14,17,10,9,10,12,10,8,8,11,19,15,28,10,17,0,7,9,15,5,12,4,20654,18204,16783,18089,121463,140396,171848,48351,14509,9379,178121,248750,0,0,0,0,49695,68662,81413,22495,0,0,70319,75299,2743,1097,1107,1168,624,579,716,754,672,522,466,912,3971,4579,5764,2480,5556,0,2262,2636,6256,1932,1918,3550,45,36,40,33,36,40,44,49,59,40,33,43,57230,50116,39250,38339,49802,40246,40643,48504,56951,47574,46410,50666,543,530,293,260,278,210,344,361,587,445,198,232,818,1161,2033,1537,1008,896,1074,1884,960,496,803,2315,99,87,94,94,76,83,81,96,112,74,61,81,122018,153575,203795,102958,336098,272558,275045,152511,124616,90097,361052,490925,4515,3930,4936,2163,2348,4268,2765,3741,2706,1669,5575,12154,13411,14284,17732,9274,10945,23421,36117,12355,11742,7351,23613,45322,null,null,null,null,null,null,null,null,null,null,null,null,11410,11536,11715,11797,11856,11925,12022,12064,12139,12220,12257,12339,9712,9769,9783,9817,9857,9904,9958,9988,10016,10057,10093,10157,10315,10344,10336,10345,10357,10337,10315,10342,10353,10354,10258,10236,213,224,214,216,220,228,226,233,242,247,251,253,null,null,null,null,null,null,null,null,null,null,null,null,11,7,10,12,5,6,7,10,14,3,6,1,29204,26532,31073,31396,30414,25191,29839,24171,35845,48054,42308,36133,59,2,2,10,6,3,9,8,5,4,7,6,null,null,null,null,null,null,null,null,null,null,null,null,11807,11648,13256,6956,5819,3806,3793,7368,9023,5662,11743,16704,null,null,null,null,null,null,null,null,null,null,null,null,5,31,16,11,5,15,4,9,11,14,4,8,2496,3194,2297,2862,2147,2169,1920,2006,2220,2190,2183,3091]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>date<\/th>\n      <th>metric<\/th>\n      <th>value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":3},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>For convenience, I just pivoted across any column with a type of double. This picked up the Totals column too, so I dropped that one immediately as it’s not necessary. I also selected only the “cleaned” columns (and re-named the first column along the way), although there’s obviously a job to be performed on our date column.</p>
<p>It turns out that converting Excel numbers to dates is pretty easy with janitor: just use the excel_numeric_to_date function, and voila! Of course I need to convert this column back to numeric first, it having been converted to a character type during the pivoting process (the the excel_numeric_to_date function always returns a character vector)…</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">first_sheet_with_dates</span> <span class="op">&lt;-</span> <span class="va">first_sheet_long</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/excel_numeric_to_date.html">excel_numeric_to_date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">metric</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">first_sheet_with_dates</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-adec31ad6b6ef07a796b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-adec31ad6b6ef07a796b">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348"],["2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01"],["Facebook posts","Facebook posts","Facebook posts","Facebook posts","Facebook posts","Facebook posts","Facebook posts","Facebook posts","Facebook posts","Facebook posts","Facebook posts","Facebook posts","Facebook reach (total)","Facebook reach (total)","Facebook reach (total)","Facebook reach (total)","Facebook reach (total)","Facebook reach (total)","Facebook reach (total)","Facebook reach (total)","Facebook reach (total)","Facebook reach (total)","Facebook reach (total)","Facebook reach (total)","Facebook paid reach","Facebook paid reach","Facebook paid reach","Facebook paid reach","Facebook paid reach","Facebook paid reach","Facebook paid reach","Facebook paid reach","Facebook paid reach","Facebook paid reach","Facebook paid reach","Facebook paid reach","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook engagement (reactions, shares, comments) and link clicks.","Facebook video views","Facebook video views","Facebook video views","Facebook video views","Facebook video views","Facebook video views","Facebook video views","Facebook video views","Facebook video views","Facebook video views","Facebook video views","Facebook video views","Instagram posts","Instagram posts","Instagram posts","Instagram posts","Instagram posts","Instagram posts","Instagram posts","Instagram posts","Instagram posts","Instagram posts","Instagram posts","Instagram posts","Instagram stories","Instagram stories","Instagram stories","Instagram stories","Instagram stories","Instagram stories","Instagram stories","Instagram stories","Instagram stories","Instagram stories","Instagram stories","Instagram stories","Instagram reach (total)","Instagram reach (total)","Instagram reach (total)","Instagram reach (total)","Instagram reach (total)","Instagram reach (total)","Instagram reach (total)","Instagram reach (total)","Instagram reach (total)","Instagram reach (total)","Instagram reach (total)","Instagram reach (total)","Instagram paid reach","Instagram paid reach","Instagram paid reach","Instagram paid reach","Instagram paid reach","Instagram paid reach","Instagram paid reach","Instagram paid reach","Instagram paid reach","Instagram paid reach","Instagram paid reach","Instagram paid reach","Instagram engagement (likes, comments, saves and link clicks)","Instagram engagement (likes, comments, saves and link clicks)","Instagram engagement (likes, comments, saves and link clicks)","Instagram engagement (likes, comments, saves and link clicks)","Instagram engagement (likes, comments, saves and link clicks)","Instagram engagement (likes, comments, saves and link clicks)","Instagram engagement (likes, comments, saves and link clicks)","Instagram engagement (likes, comments, saves and link clicks)","Instagram engagement (likes, comments, saves and link clicks)","Instagram engagement (likes, comments, saves and link clicks)","Instagram engagement (likes, comments, saves and link clicks)","Instagram engagement (likes, comments, saves and link clicks)","Instagram Stories Reach","Instagram Stories Reach","Instagram Stories Reach","Instagram Stories Reach","Instagram Stories Reach","Instagram Stories Reach","Instagram Stories Reach","Instagram Stories Reach","Instagram Stories Reach","Instagram Stories Reach","Instagram Stories Reach","Instagram Stories Reach","Twitter posts","Twitter posts","Twitter posts","Twitter posts","Twitter posts","Twitter posts","Twitter posts","Twitter posts","Twitter posts","Twitter posts","Twitter posts","Twitter posts","Twitter impressions","Twitter impressions","Twitter impressions","Twitter impressions","Twitter impressions","Twitter impressions","Twitter impressions","Twitter impressions","Twitter impressions","Twitter impressions","Twitter impressions","Twitter impressions","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","Twitter video views","Twitter video views","Twitter video views","Twitter video views","Twitter video views","Twitter video views","Twitter video views","Twitter video views","Twitter video views","Twitter video views","Twitter video views","Twitter video views","Total social posts","Total social posts","Total social posts","Total social posts","Total social posts","Total social posts","Total social posts","Total social posts","Total social posts","Total social posts","Total social posts","Total social posts","Total social post reach","Total social post reach","Total social post reach","Total social post reach","Total social post reach","Total social post reach","Total social post reach","Total social post reach","Total social post reach","Total social post reach","Total social post reach","Total social post reach","Total social post engagement","Total social post engagement","Total social post engagement","Total social post engagement","Total social post engagement","Total social post engagement","Total social post engagement","Total social post engagement","Total social post engagement","Total social post engagement","Total social post engagement","Total social post engagement","Total video views (includes YouTube)","Total video views (includes YouTube)","Total video views (includes YouTube)","Total video views (includes YouTube)","Total video views (includes YouTube)","Total video views (includes YouTube)","Total video views (includes YouTube)","Total video views (includes YouTube)","Total video views (includes YouTube)","Total video views (includes YouTube)","Total video views (includes YouTube)","Total video views (includes YouTube)","Facebook followers","Facebook followers","Facebook followers","Facebook followers","Facebook followers","Facebook followers","Facebook followers","Facebook followers","Facebook followers","Facebook followers","Facebook followers","Facebook followers","Instagram followers","Instagram followers","Instagram followers","Instagram followers","Instagram followers","Instagram followers","Instagram followers","Instagram followers","Instagram followers","Instagram followers","Instagram followers","Instagram followers","Twitter followers","Twitter followers","Twitter followers","Twitter followers","Twitter followers","Twitter followers","Twitter followers","Twitter followers","Twitter followers","Twitter followers","Twitter followers","Twitter followers","SoundCloud subscribers","SoundCloud subscribers","SoundCloud subscribers","SoundCloud subscribers","SoundCloud subscribers","SoundCloud subscribers","SoundCloud subscribers","SoundCloud subscribers","SoundCloud subscribers","SoundCloud subscribers","SoundCloud subscribers","SoundCloud subscribers","Blog posts (Libraries + Heritage et AL)","Blog posts (Libraries + Heritage et AL)","Blog posts (Libraries + Heritage et AL)","Blog posts (Libraries + Heritage et AL)","Blog posts (Libraries + Heritage et AL)","Blog posts (Libraries + Heritage et AL)","Blog posts (Libraries + Heritage et AL)","Blog posts (Libraries + Heritage et AL)","Blog posts (Libraries + Heritage et AL)","Blog posts (Libraries + Heritage et AL)","Blog posts (Libraries + Heritage et AL)","Blog posts (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog page views (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","Blog comments (Libraries + Heritage et AL)","YouTube views","YouTube views","YouTube views","YouTube views","YouTube views","YouTube views","YouTube views","YouTube views","YouTube views","YouTube views","YouTube views","YouTube views","Sound Cloud podcasts","Sound Cloud podcasts","Sound Cloud podcasts","Sound Cloud podcasts","Sound Cloud podcasts","Sound Cloud podcasts","Sound Cloud podcasts","Sound Cloud podcasts","Sound Cloud podcasts","Sound Cloud podcasts","Sound Cloud podcasts","Sound Cloud podcasts","Sound Cloud podcast listens","Sound Cloud podcast listens","Sound Cloud podcast listens","Sound Cloud podcast listens","Sound Cloud podcast listens","Sound Cloud podcast listens","Sound Cloud podcast listens","Sound Cloud podcast listens","Sound Cloud podcast listens","Sound Cloud podcast listens","Sound Cloud podcast listens","Sound Cloud podcast listens"],[43,40,40,44,30,34,27,35,43,26,20,27,44134,85255,147762,46530,164833,91916,62554,55656,53156,33144,136521,191509,1485,0,0,0,118202,59817,45465,12114,0,0,115117,154593,1229,2303,3536,735,1446,3479,1705,2626,1447,702,4911,11010,786,1475,2443,781,4118,18719,31250,3103,1759,1193,11067,26303,11,11,14,17,10,9,10,12,10,8,8,11,19,15,28,10,17,0,7,9,15,5,12,4,20654,18204,16783,18089,121463,140396,171848,48351,14509,9379,178121,248750,0,0,0,0,49695,68662,81413,22495,0,0,70319,75299,2743,1097,1107,1168,624,579,716,754,672,522,466,912,3971,4579,5764,2480,5556,0,2262,2636,6256,1932,1918,3550,45,36,40,33,36,40,44,49,59,40,33,43,57230,50116,39250,38339,49802,40246,40643,48504,56951,47574,46410,50666,543,530,293,260,278,210,344,361,587,445,198,232,818,1161,2033,1537,1008,896,1074,1884,960,496,803,2315,99,87,94,94,76,83,81,96,112,74,61,81,122018,153575,203795,102958,336098,272558,275045,152511,124616,90097,361052,490925,4515,3930,4936,2163,2348,4268,2765,3741,2706,1669,5575,12154,13411,14284,17732,9274,10945,23421,36117,12355,11742,7351,23613,45322,11410,11536,11715,11797,11856,11925,12022,12064,12139,12220,12257,12339,9712,9769,9783,9817,9857,9904,9958,9988,10016,10057,10093,10157,10315,10344,10336,10345,10357,10337,10315,10342,10353,10354,10258,10236,213,224,214,216,220,228,226,233,242,247,251,253,11,7,10,12,5,6,7,10,14,3,6,1,29204,26532,31073,31396,30414,25191,29839,24171,35845,48054,42308,36133,59,2,2,10,6,3,9,8,5,4,7,6,11807,11648,13256,6956,5819,3806,3793,7368,9023,5662,11743,16704,5,31,16,11,5,15,4,9,11,14,4,8,2496,3194,2297,2862,2147,2169,1920,2006,2220,2190,2183,3091]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>date<\/th>\n      <th>metric<\/th>\n      <th>value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":3},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Magic! This is now a semi-tidy data frame. Note that I dropped any rows where there’s an NA in the metric column, as in the original data these were empty rows to separate groups of metrics from each other for aesthetic purposes.</p>
</section><section id="cleaning-string-values" class="level2"><h2 class="anchored" data-anchor-id="cleaning-string-values">Cleaning string values</h2>
<p>I said it’s “semi-tidy” because the metric column is holding two values: the platform <em>and</em> the metric name. We should probably separate these two out.</p>
<p>How do we do this? We’re going to use str_detect() from the stringr package, which allows us to search for a pattern in a string and pass that to a conditional statement within a mutate. We first convert the values in the metric column to lowercase to simplify matters…</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">first_sheet_with_platforms</span> <span class="op">&lt;-</span> <span class="va">first_sheet_with_dates</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    metric <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html">str_to_lower</a></span><span class="op">(</span><span class="va">metric</span><span class="op">)</span>,</span>
<span>    platform <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"facebook"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Facebook"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"twitter"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Twitter"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"instagram"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Instagram"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"youtube views"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"YouTube"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"soundcloud"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Sound Cloud"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"sound cloud"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Sound Cloud"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"blog"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Blogs"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">platform</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">first_sheet_with_platforms</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-15a50d279e16d732d4e6" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-15a50d279e16d732d4e6">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300"],["2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01"],["facebook posts","facebook posts","facebook posts","facebook posts","facebook posts","facebook posts","facebook posts","facebook posts","facebook posts","facebook posts","facebook posts","facebook posts","facebook reach (total)","facebook reach (total)","facebook reach (total)","facebook reach (total)","facebook reach (total)","facebook reach (total)","facebook reach (total)","facebook reach (total)","facebook reach (total)","facebook reach (total)","facebook reach (total)","facebook reach (total)","facebook paid reach","facebook paid reach","facebook paid reach","facebook paid reach","facebook paid reach","facebook paid reach","facebook paid reach","facebook paid reach","facebook paid reach","facebook paid reach","facebook paid reach","facebook paid reach","facebook engagement (reactions, shares, comments) and link clicks.","facebook engagement (reactions, shares, comments) and link clicks.","facebook engagement (reactions, shares, comments) and link clicks.","facebook engagement (reactions, shares, comments) and link clicks.","facebook engagement (reactions, shares, comments) and link clicks.","facebook engagement (reactions, shares, comments) and link clicks.","facebook engagement (reactions, shares, comments) and link clicks.","facebook engagement (reactions, shares, comments) and link clicks.","facebook engagement (reactions, shares, comments) and link clicks.","facebook engagement (reactions, shares, comments) and link clicks.","facebook engagement (reactions, shares, comments) and link clicks.","facebook engagement (reactions, shares, comments) and link clicks.","facebook video views","facebook video views","facebook video views","facebook video views","facebook video views","facebook video views","facebook video views","facebook video views","facebook video views","facebook video views","facebook video views","facebook video views","instagram posts","instagram posts","instagram posts","instagram posts","instagram posts","instagram posts","instagram posts","instagram posts","instagram posts","instagram posts","instagram posts","instagram posts","instagram stories","instagram stories","instagram stories","instagram stories","instagram stories","instagram stories","instagram stories","instagram stories","instagram stories","instagram stories","instagram stories","instagram stories","instagram reach (total)","instagram reach (total)","instagram reach (total)","instagram reach (total)","instagram reach (total)","instagram reach (total)","instagram reach (total)","instagram reach (total)","instagram reach (total)","instagram reach (total)","instagram reach (total)","instagram reach (total)","instagram paid reach","instagram paid reach","instagram paid reach","instagram paid reach","instagram paid reach","instagram paid reach","instagram paid reach","instagram paid reach","instagram paid reach","instagram paid reach","instagram paid reach","instagram paid reach","instagram engagement (likes, comments, saves and link clicks)","instagram engagement (likes, comments, saves and link clicks)","instagram engagement (likes, comments, saves and link clicks)","instagram engagement (likes, comments, saves and link clicks)","instagram engagement (likes, comments, saves and link clicks)","instagram engagement (likes, comments, saves and link clicks)","instagram engagement (likes, comments, saves and link clicks)","instagram engagement (likes, comments, saves and link clicks)","instagram engagement (likes, comments, saves and link clicks)","instagram engagement (likes, comments, saves and link clicks)","instagram engagement (likes, comments, saves and link clicks)","instagram engagement (likes, comments, saves and link clicks)","instagram stories reach","instagram stories reach","instagram stories reach","instagram stories reach","instagram stories reach","instagram stories reach","instagram stories reach","instagram stories reach","instagram stories reach","instagram stories reach","instagram stories reach","instagram stories reach","twitter posts","twitter posts","twitter posts","twitter posts","twitter posts","twitter posts","twitter posts","twitter posts","twitter posts","twitter posts","twitter posts","twitter posts","twitter impressions","twitter impressions","twitter impressions","twitter impressions","twitter impressions","twitter impressions","twitter impressions","twitter impressions","twitter impressions","twitter impressions","twitter impressions","twitter impressions","twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","twitter video views","twitter video views","twitter video views","twitter video views","twitter video views","twitter video views","twitter video views","twitter video views","twitter video views","twitter video views","twitter video views","twitter video views","facebook followers","facebook followers","facebook followers","facebook followers","facebook followers","facebook followers","facebook followers","facebook followers","facebook followers","facebook followers","facebook followers","facebook followers","instagram followers","instagram followers","instagram followers","instagram followers","instagram followers","instagram followers","instagram followers","instagram followers","instagram followers","instagram followers","instagram followers","instagram followers","twitter followers","twitter followers","twitter followers","twitter followers","twitter followers","twitter followers","twitter followers","twitter followers","twitter followers","twitter followers","twitter followers","twitter followers","soundcloud subscribers","soundcloud subscribers","soundcloud subscribers","soundcloud subscribers","soundcloud subscribers","soundcloud subscribers","soundcloud subscribers","soundcloud subscribers","soundcloud subscribers","soundcloud subscribers","soundcloud subscribers","soundcloud subscribers","blog posts (libraries + heritage et al)","blog posts (libraries + heritage et al)","blog posts (libraries + heritage et al)","blog posts (libraries + heritage et al)","blog posts (libraries + heritage et al)","blog posts (libraries + heritage et al)","blog posts (libraries + heritage et al)","blog posts (libraries + heritage et al)","blog posts (libraries + heritage et al)","blog posts (libraries + heritage et al)","blog posts (libraries + heritage et al)","blog posts (libraries + heritage et al)","blog page views (libraries + heritage et al)","blog page views (libraries + heritage et al)","blog page views (libraries + heritage et al)","blog page views (libraries + heritage et al)","blog page views (libraries + heritage et al)","blog page views (libraries + heritage et al)","blog page views (libraries + heritage et al)","blog page views (libraries + heritage et al)","blog page views (libraries + heritage et al)","blog page views (libraries + heritage et al)","blog page views (libraries + heritage et al)","blog page views (libraries + heritage et al)","blog comments (libraries + heritage et al)","blog comments (libraries + heritage et al)","blog comments (libraries + heritage et al)","blog comments (libraries + heritage et al)","blog comments (libraries + heritage et al)","blog comments (libraries + heritage et al)","blog comments (libraries + heritage et al)","blog comments (libraries + heritage et al)","blog comments (libraries + heritage et al)","blog comments (libraries + heritage et al)","blog comments (libraries + heritage et al)","blog comments (libraries + heritage et al)","youtube views","youtube views","youtube views","youtube views","youtube views","youtube views","youtube views","youtube views","youtube views","youtube views","youtube views","youtube views","sound cloud podcasts","sound cloud podcasts","sound cloud podcasts","sound cloud podcasts","sound cloud podcasts","sound cloud podcasts","sound cloud podcasts","sound cloud podcasts","sound cloud podcasts","sound cloud podcasts","sound cloud podcasts","sound cloud podcasts","sound cloud podcast listens","sound cloud podcast listens","sound cloud podcast listens","sound cloud podcast listens","sound cloud podcast listens","sound cloud podcast listens","sound cloud podcast listens","sound cloud podcast listens","sound cloud podcast listens","sound cloud podcast listens","sound cloud podcast listens","sound cloud podcast listens"],[43,40,40,44,30,34,27,35,43,26,20,27,44134,85255,147762,46530,164833,91916,62554,55656,53156,33144,136521,191509,1485,0,0,0,118202,59817,45465,12114,0,0,115117,154593,1229,2303,3536,735,1446,3479,1705,2626,1447,702,4911,11010,786,1475,2443,781,4118,18719,31250,3103,1759,1193,11067,26303,11,11,14,17,10,9,10,12,10,8,8,11,19,15,28,10,17,0,7,9,15,5,12,4,20654,18204,16783,18089,121463,140396,171848,48351,14509,9379,178121,248750,0,0,0,0,49695,68662,81413,22495,0,0,70319,75299,2743,1097,1107,1168,624,579,716,754,672,522,466,912,3971,4579,5764,2480,5556,0,2262,2636,6256,1932,1918,3550,45,36,40,33,36,40,44,49,59,40,33,43,57230,50116,39250,38339,49802,40246,40643,48504,56951,47574,46410,50666,543,530,293,260,278,210,344,361,587,445,198,232,818,1161,2033,1537,1008,896,1074,1884,960,496,803,2315,11410,11536,11715,11797,11856,11925,12022,12064,12139,12220,12257,12339,9712,9769,9783,9817,9857,9904,9958,9988,10016,10057,10093,10157,10315,10344,10336,10345,10357,10337,10315,10342,10353,10354,10258,10236,213,224,214,216,220,228,226,233,242,247,251,253,11,7,10,12,5,6,7,10,14,3,6,1,29204,26532,31073,31396,30414,25191,29839,24171,35845,48054,42308,36133,59,2,2,10,6,3,9,8,5,4,7,6,11807,11648,13256,6956,5819,3806,3793,7368,9023,5662,11743,16704,5,31,16,11,5,15,4,9,11,14,4,8,2496,3194,2297,2862,2147,2169,1920,2006,2220,2190,2183,3091],["Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>date<\/th>\n      <th>metric<\/th>\n      <th>value<\/th>\n      <th>platform<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":3},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The eagle-eyed among you may have noticed that I dealt with YouTube in an unusual way here by searching for “youtube views”, and that’s because one of the metrics is called “Total video views (includes YouTube)”, which I don’t want to classify as YouTube. In addition, I filtered out any rows where a value for the platform column wasn’t supplied during my case_when checks: these are the metrics that are totals of some kind (which is different from the total for the year-to-date, which we removed earlier).</p>
<p>Let’s go a step further here and standardise the names of the metrics too. To begin with, let’s examine how each of the metric names is recorded:</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">first_sheet_with_platforms</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">platform</span>, <span class="va">metric</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-dc3d33e5e205b4d38a9b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-dc3d33e5e205b4d38a9b">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25"],["facebook posts","facebook reach (total)","facebook paid reach","facebook engagement (reactions, shares, comments) and link clicks.","facebook video views","instagram posts","instagram stories","instagram reach (total)","instagram paid reach","instagram engagement (likes, comments, saves and link clicks)","instagram stories reach","twitter posts","twitter impressions","twitter engagement (link clicks, likes, retweets, replies and retweets with comments)","twitter video views","facebook followers","instagram followers","twitter followers","soundcloud subscribers","blog posts (libraries + heritage et al)","blog page views (libraries + heritage et al)","blog comments (libraries + heritage et al)","youtube views","sound cloud podcasts","sound cloud podcast listens"],["Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Facebook","Instagram","Twitter","Sound Cloud","Blogs","Blogs","Blogs","YouTube","Sound Cloud","Sound Cloud"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>metric<\/th>\n      <th>platform<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Looking at this, we can see that the simplest way to standardise the metric names is by removing the name of the platform, as well as everything within and after any parentheses.</p>
<p>gsub from base R can help us to deal with the parentheses issues, as it uses a simple regular expression to target the string ” (” and everything after it.</p>
<p>To remove the names of the platforms, we can use sub and pass a regular expression that targets the first word and the space after it and replaces it with nothing. We need to make an exception for SoundCloud, which is sometimes spelt “Sound Cloud” and hence will require removing two words:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">first_sheet_with_metrics</span> <span class="op">&lt;-</span> <span class="va">first_sheet_with_platforms</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    metric_cleaned <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">" \\(.*"</span>, <span class="st">""</span>, <span class="va">metric</span><span class="op">)</span>,</span>
<span>    metric_name <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"sound cloud"</span>, <span class="va">metric</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">==</span> <span class="cn">TRUE</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"total facebook"</span>, <span class="va">metric</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">==</span> <span class="cn">TRUE</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"^\\w+\\s\\w+\\s"</span>, <span class="st">""</span>, <span class="va">metric_cleaned</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"^\\w+\\s"</span>, <span class="st">""</span>, <span class="va">metric_cleaned</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">platform</span>, <span class="va">metric_name</span>, <span class="va">date</span>, <span class="va">value</span><span class="op">)</span></span>
<span></span>
<span><span class="va">first_sheet_with_metrics</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-8b0a003b10ac4183536c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-8b0a003b10ac4183536c">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300"],["Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud"],["posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","stories","stories","stories","stories","stories","stories","stories","stories","stories","stories","stories","stories","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","stories reach","stories reach","stories reach","stories reach","stories reach","stories reach","stories reach","stories reach","stories reach","stories reach","stories reach","stories reach","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","views","views","views","views","views","views","views","views","views","views","views","views","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens"],["2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01"],[43,40,40,44,30,34,27,35,43,26,20,27,44134,85255,147762,46530,164833,91916,62554,55656,53156,33144,136521,191509,1485,0,0,0,118202,59817,45465,12114,0,0,115117,154593,1229,2303,3536,735,1446,3479,1705,2626,1447,702,4911,11010,786,1475,2443,781,4118,18719,31250,3103,1759,1193,11067,26303,11,11,14,17,10,9,10,12,10,8,8,11,19,15,28,10,17,0,7,9,15,5,12,4,20654,18204,16783,18089,121463,140396,171848,48351,14509,9379,178121,248750,0,0,0,0,49695,68662,81413,22495,0,0,70319,75299,2743,1097,1107,1168,624,579,716,754,672,522,466,912,3971,4579,5764,2480,5556,0,2262,2636,6256,1932,1918,3550,45,36,40,33,36,40,44,49,59,40,33,43,57230,50116,39250,38339,49802,40246,40643,48504,56951,47574,46410,50666,543,530,293,260,278,210,344,361,587,445,198,232,818,1161,2033,1537,1008,896,1074,1884,960,496,803,2315,11410,11536,11715,11797,11856,11925,12022,12064,12139,12220,12257,12339,9712,9769,9783,9817,9857,9904,9958,9988,10016,10057,10093,10157,10315,10344,10336,10345,10357,10337,10315,10342,10353,10354,10258,10236,213,224,214,216,220,228,226,233,242,247,251,253,11,7,10,12,5,6,7,10,14,3,6,1,29204,26532,31073,31396,30414,25191,29839,24171,35845,48054,42308,36133,59,2,2,10,6,3,9,8,5,4,7,6,11807,11648,13256,6956,5819,3806,3793,7368,9023,5662,11743,16704,5,31,16,11,5,15,4,9,11,14,4,8,2496,3194,2297,2862,2147,2169,1920,2006,2220,2190,2183,3091]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>platform<\/th>\n      <th>metric_name<\/th>\n      <th>date<\/th>\n      <th>value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":4},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section><section id="bringing-it-all-together" class="level2"><h2 class="anchored" data-anchor-id="bringing-it-all-together">Bringing it all together</h2>
<p>Let’s bring all of these steps together into one data pipeline, which we’ll improve by dropping columns we don’t need from the start (including the Totals column, and a column that contains a note for one of the rows). We’ll also drop any rows where we can’t extract a platform name, as these will be either “Totals” or empty rows used to separate things for aesthetic purposes in the Excel spreadsheet:</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">excel_file</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html">dir_ls</a></span><span class="op">(</span>glob <span class="op">=</span> <span class="st">"*.xlsx"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sheet_1_tidy_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">excel_file</span>, range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/cellranger/man/cell_cols.html">cell_cols</a></span><span class="op">(</span><span class="st">"A:M"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">where</span><span class="op">(</span><span class="va">is.double</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/excel_numeric_to_date.html">excel_numeric_to_date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    metric <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html">str_to_lower</a></span><span class="op">(</span><span class="va">...1</span><span class="op">)</span>,</span>
<span>    platform <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"facebook"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Facebook"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"twitter"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Twitter"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"instagram"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Instagram"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"youtube views"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"YouTube"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"soundcloud"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Sound Cloud"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"sound cloud"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Sound Cloud"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"blog"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Blogs"</span></span>
<span>      <span class="op">)</span>,</span>
<span>    metric_cleaned <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">" \\(.*"</span>, <span class="st">""</span>, <span class="va">...1</span><span class="op">)</span>,</span>
<span>    metric_name <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"sound cloud"</span>, <span class="va">metric_cleaned</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">==</span> <span class="cn">TRUE</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"total facebook"</span>, <span class="va">metric_cleaned</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">==</span> <span class="cn">TRUE</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"^\\w+\\s\\w+\\s"</span>, <span class="st">""</span>, <span class="va">metric_cleaned</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"^\\w+\\s"</span>, <span class="st">""</span>, <span class="va">metric_cleaned</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">platform</span>, <span class="va">metric_name</span>, <span class="va">value</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">platform</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sheet_1_tidy_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-e44fdf98af595407f84e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e44fdf98af595407f84e">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300"],["2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01"],["Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud"],["posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","stories","stories","stories","stories","stories","stories","stories","stories","stories","stories","stories","stories","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","views","views","views","views","views","views","views","views","views","views","views","views","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens"],[43,40,40,44,30,34,27,35,43,26,20,27,44134,85255,147762,46530,164833,91916,62554,55656,53156,33144,136521,191509,1485,0,0,0,118202,59817,45465,12114,0,0,115117,154593,1229,2303,3536,735,1446,3479,1705,2626,1447,702,4911,11010,786,1475,2443,781,4118,18719,31250,3103,1759,1193,11067,26303,11,11,14,17,10,9,10,12,10,8,8,11,19,15,28,10,17,0,7,9,15,5,12,4,20654,18204,16783,18089,121463,140396,171848,48351,14509,9379,178121,248750,0,0,0,0,49695,68662,81413,22495,0,0,70319,75299,2743,1097,1107,1168,624,579,716,754,672,522,466,912,3971,4579,5764,2480,5556,0,2262,2636,6256,1932,1918,3550,45,36,40,33,36,40,44,49,59,40,33,43,57230,50116,39250,38339,49802,40246,40643,48504,56951,47574,46410,50666,543,530,293,260,278,210,344,361,587,445,198,232,818,1161,2033,1537,1008,896,1074,1884,960,496,803,2315,11410,11536,11715,11797,11856,11925,12022,12064,12139,12220,12257,12339,9712,9769,9783,9817,9857,9904,9958,9988,10016,10057,10093,10157,10315,10344,10336,10345,10357,10337,10315,10342,10353,10354,10258,10236,213,224,214,216,220,228,226,233,242,247,251,253,11,7,10,12,5,6,7,10,14,3,6,1,29204,26532,31073,31396,30414,25191,29839,24171,35845,48054,42308,36133,59,2,2,10,6,3,9,8,5,4,7,6,11807,11648,13256,6956,5819,3806,3793,7368,9023,5662,11743,16704,5,31,16,11,5,15,4,9,11,14,4,8,2496,3194,2297,2862,2147,2169,1920,2006,2220,2190,2183,3091]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>date<\/th>\n      <th>platform<\/th>\n      <th>metric_name<\/th>\n      <th>value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":4},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>We need to apply these same steps on sheets 2 and 3. To do this, we’ll create named objects for each sheet and pipe them into our data cleaning script:</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">excel_file</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html">dir_ls</a></span><span class="op">(</span>glob <span class="op">=</span> <span class="st">"*.xlsx"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sheet_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">excel_file</span>, range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/cellranger/man/cell_cols.html">cell_cols</a></span><span class="op">(</span><span class="st">"A:M"</span><span class="op">)</span>, sheet <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">sheet_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">excel_file</span>, range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/cellranger/man/cell_cols.html">cell_cols</a></span><span class="op">(</span><span class="st">"A:M"</span><span class="op">)</span>, sheet <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">sheet_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">excel_file</span>, range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/cellranger/man/cell_cols.html">cell_cols</a></span><span class="op">(</span><span class="st">"A:M"</span><span class="op">)</span>, sheet <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sheet_1_tidy_data</span> <span class="op">&lt;-</span> <span class="va">sheet_1</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">where</span><span class="op">(</span><span class="va">is.double</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/excel_numeric_to_date.html">excel_numeric_to_date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    metric <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html">str_to_lower</a></span><span class="op">(</span><span class="va">...1</span><span class="op">)</span>,</span>
<span>    platform <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"facebook"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Facebook"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"twitter"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Twitter"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"instagram"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Instagram"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"youtube views"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"YouTube"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"soundcloud"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Sound Cloud"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"sound cloud"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Sound Cloud"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"blog"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Blogs"</span></span>
<span>      <span class="op">)</span>,</span>
<span>    metric_cleaned <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">" \\(.*"</span>, <span class="st">""</span>, <span class="va">...1</span><span class="op">)</span>,</span>
<span>    metric_name <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"sound cloud"</span>, <span class="va">metric_cleaned</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">==</span> <span class="cn">TRUE</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"total facebook"</span>, <span class="va">metric_cleaned</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">==</span> <span class="cn">TRUE</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"^\\w+\\s\\w+\\s"</span>, <span class="st">""</span>, <span class="va">metric_cleaned</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"^\\w+\\s"</span>, <span class="st">""</span>, <span class="va">metric_cleaned</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">platform</span>, <span class="va">metric_name</span>, <span class="va">value</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">platform</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sheet_2_tidy_data</span> <span class="op">&lt;-</span> <span class="va">sheet_2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">where</span><span class="op">(</span><span class="va">is.double</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/excel_numeric_to_date.html">excel_numeric_to_date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    metric <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html">str_to_lower</a></span><span class="op">(</span><span class="va">...1</span><span class="op">)</span>,</span>
<span>    platform <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"facebook"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Facebook"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"twitter"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Twitter"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"instagram"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Instagram"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"youtube views"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"YouTube"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"soundcloud"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Sound Cloud"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"sound cloud"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Sound Cloud"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"blog"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Blogs"</span></span>
<span>      <span class="op">)</span>,</span>
<span>    metric_cleaned <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">" \\(.*"</span>, <span class="st">""</span>, <span class="va">...1</span><span class="op">)</span>,</span>
<span>    metric_name <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"sound cloud"</span>, <span class="va">metric_cleaned</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">==</span> <span class="cn">TRUE</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"total facebook"</span>, <span class="va">metric_cleaned</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">==</span> <span class="cn">TRUE</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"^\\w+\\s\\w+\\s"</span>, <span class="st">""</span>, <span class="va">metric_cleaned</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"^\\w+\\s"</span>, <span class="st">""</span>, <span class="va">metric_cleaned</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">platform</span>, <span class="va">metric_name</span>, <span class="va">value</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">platform</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sheet_3_tidy_data</span> <span class="op">&lt;-</span> <span class="va">sheet_3</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">where</span><span class="op">(</span><span class="va">is.double</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/excel_numeric_to_date.html">excel_numeric_to_date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    metric <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html">str_to_lower</a></span><span class="op">(</span><span class="va">...1</span><span class="op">)</span>,</span>
<span>    platform <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"facebook"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Facebook"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"twitter"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Twitter"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"instagram"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Instagram"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"youtube views"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"YouTube"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"soundcloud"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Sound Cloud"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"sound cloud"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Sound Cloud"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"blog"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Blogs"</span></span>
<span>      <span class="op">)</span>,</span>
<span>    metric_cleaned <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">" \\(.*"</span>, <span class="st">""</span>, <span class="va">...1</span><span class="op">)</span>,</span>
<span>    metric_name <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"sound cloud"</span>, <span class="va">metric_cleaned</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">==</span> <span class="cn">TRUE</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"total facebook"</span>, <span class="va">metric_cleaned</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">==</span> <span class="cn">TRUE</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"^\\w+\\s\\w+\\s"</span>, <span class="st">""</span>, <span class="va">metric_cleaned</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"^\\w+\\s"</span>, <span class="st">""</span>, <span class="va">metric_cleaned</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">platform</span>, <span class="va">metric_name</span>, <span class="va">value</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">platform</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, let’s bring all three data frames together into one source (assigning an ID to each one as we do so that links each row back to a Financial Year):</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"FY21"</span> <span class="op">=</span> <span class="va">sheet_1_tidy_data</span>,</span>
<span>  <span class="st">"FY22"</span> <span class="op">=</span> <span class="va">sheet_2_tidy_data</span>,</span>
<span>  <span class="st">"FY23"</span> <span class="op">=</span> <span class="va">sheet_3_tidy_data</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">libraries_social_media</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  .id <span class="op">=</span> <span class="st">"source"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">libraries_social_media</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-2fcc163f366491aeef40" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2fcc163f366491aeef40">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766","767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787","788","789","790","791","792","793","794","795","796","797","798","799","800","801","802","803","804","805","806","807","808","809","810","811","812","813","814","815","816","817","818","819","820","821","822","823","824","825","826","827","828","829","830","831","832","833","834","835","836","837","838","839","840","841","842","843","844","845","846","847","848","849","850","851","852","853","854","855","856","857","858","859","860","861","862","863","864","865","866","867","868","869","870","871","872","873","874","875","876","877","878","879","880","881","882","883","884","885","886","887","888","889","890","891","892","893","894","895","896","897","898","899","900","901","902","903","904","905","906","907","908","909","910","911","912","913","914","915","916","917","918","919","920","921","922","923","924","925","926","927","928","929","930","931","932","933","934","935","936","937","938","939","940","941","942","943","944","945","946","947","948","949","950","951","952","953","954","955","956","957","958","959","960","961","962","963","964","965","966","967","968","969","970","971","972","973","974","975","976","977","978","979","980","981","982","983","984","985","986","987","988","989","990","991","992","993","994","995","996"],["FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23"],["2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01"],["Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud"],["posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","stories","stories","stories","stories","stories","stories","stories","stories","stories","stories","stories","stories","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","views","views","views","views","views","views","views","views","views","views","views","views","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","views","views","views","views","views","views","views","views","views","views","views","views","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","views","views","views","views","views","views","views","views","views","views","views","views","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays"],[43,40,40,44,30,34,27,35,43,26,20,27,44134,85255,147762,46530,164833,91916,62554,55656,53156,33144,136521,191509,1485,0,0,0,118202,59817,45465,12114,0,0,115117,154593,1229,2303,3536,735,1446,3479,1705,2626,1447,702,4911,11010,786,1475,2443,781,4118,18719,31250,3103,1759,1193,11067,26303,11,11,14,17,10,9,10,12,10,8,8,11,19,15,28,10,17,0,7,9,15,5,12,4,20654,18204,16783,18089,121463,140396,171848,48351,14509,9379,178121,248750,0,0,0,0,49695,68662,81413,22495,0,0,70319,75299,2743,1097,1107,1168,624,579,716,754,672,522,466,912,3971,4579,5764,2480,5556,0,2262,2636,6256,1932,1918,3550,45,36,40,33,36,40,44,49,59,40,33,43,57230,50116,39250,38339,49802,40246,40643,48504,56951,47574,46410,50666,543,530,293,260,278,210,344,361,587,445,198,232,818,1161,2033,1537,1008,896,1074,1884,960,496,803,2315,11410,11536,11715,11797,11856,11925,12022,12064,12139,12220,12257,12339,9712,9769,9783,9817,9857,9904,9958,9988,10016,10057,10093,10157,10315,10344,10336,10345,10357,10337,10315,10342,10353,10354,10258,10236,213,224,214,216,220,228,226,233,242,247,251,253,11,7,10,12,5,6,7,10,14,3,6,1,29204,26532,31073,31396,30414,25191,29839,24171,35845,48054,42308,36133,59,2,2,10,6,3,9,8,5,4,7,6,11807,11648,13256,6956,5819,3806,3793,7368,9023,5662,11743,16704,5,31,16,11,5,15,4,9,11,14,4,8,2496,3194,2297,2862,2147,2169,1920,2006,2220,2190,2183,3091,7,14,18,7,11,15,14,14,40,32,35,36,11663,0,0,0,0,41933,19382,0,306951,299497,43844,193748,92265,61260,117794,70779,65275,101675,72570,45472,380828,353766,103960,267623,4730,3113,10837,4432,3213,5746,2555,2071,7622,4545,5675,5674,3800,6978,7939,14343,3608,11630,3184,1692,30096,14812,21129,780,7,11,13,7,9,14,13,8,23,23,22,25,0,5,18,8,4,5,0,17,63,19,49,29,1,5,2,1,1,0,0,0,0,0,0,0,33984,24220,19374,11177,13556,34593,17899,7781,21982,17401,12849,13158,0,931,3700,1630,1147,1834,0,5149,15854,3470,9657,4993,3555,13897,7064,1366,1307,0,0,0,0,0,0,0,14445,0,0,0,0,9524,0,0,53712,52190,0,12343,51984,39048,30138,14173,16010,46558,17899,12930,91548,73061,22506,30494,749,606,799,572,848,969,878,508,1396,1128,932,854,5609,15411,8888,2966,1764,4203,1304,0,1773,148,627,193,16,19,8,21,29,31,20,13,37,29,32,26,81561,33087,23051,18095,20030,34568,11960,6493,24152,19627,16019,12266,1462,553,868,605,667,754,333,222,703,599,778,591,138,1218,2517,1579,403,208,69,154,895,353,144,113,13746,13824,14070,14158,14247,14290,14303,14373,14424,14465,14515,14592,10203,10231,10276,10336,10384,10421,10456,10481,10523,10570,10597,10616,10255,10260,10267,10277,10301,10296,10300,10293,10295,10290,10288,10295,255,267,275,286,286,294,294,296,302,305,309,315,4,2,2,2,3,3,1,2,7,3,10,8,52479,36436,34032,50632,30718,26929,30152,27097,31254,31259,34210,40748,6,0,3,0,1,5,2,3,6,3,8,3,9724,11116,24356,8043,6974,3594,3402,6337,8871,7593,13567,19545,30,17,9,13,7,3,2,5,4,1,5,8,3835,3633,5069,3372,2940,1594,2252,2567,1609,1203,1213,1600,41,74,25,null,null,null,null,null,null,null,null,null,215914,362673,13450,null,null,null,null,null,null,null,null,null,301862,418194,48672,null,null,null,null,null,null,null,null,null,6520,13587,2831,null,null,null,null,null,null,null,null,null,672,5869,4106,null,null,null,null,null,null,null,null,null,23,31,17,null,null,null,null,null,null,null,null,null,14,60,17,null,null,null,null,null,null,null,null,null,0,2,0,null,null,null,null,null,null,null,null,null,13723,22968,12200,null,null,null,null,null,null,null,null,null,2968,3115,2534,null,null,null,null,null,null,null,null,null,0,3495,0,null,null,null,null,null,null,null,null,null,4573,0,0,null,null,null,null,null,null,null,null,null,21264,29578,14734,null,null,null,null,null,null,null,null,null,818,1315,624,null,null,null,null,null,null,null,null,null,449,4953,174,null,null,null,null,null,null,null,null,null,23,47,15,null,null,null,null,null,null,null,null,null,13258,25810,10819,null,null,null,null,null,null,null,null,null,580,1208,631,null,null,null,null,null,null,null,null,null,333,631,347,null,null,null,null,null,null,null,null,null,14627,14741,14797,null,null,null,null,null,null,null,null,null,10625,10680,10688,null,null,null,null,null,null,null,null,null,10296,10311,10312,null,null,null,null,null,null,null,null,null,320,326,328,null,null,null,null,null,null,null,null,null,5,7,1,null,null,null,null,null,null,null,null,null,32430,33277,28643,null,null,null,null,null,null,null,null,null,0,7,5,null,null,null,null,null,null,null,null,null,8782,10591,12531,null,null,null,null,null,null,null,null,null,3,9,3,null,null,null,null,null,null,null,null,null,1919,1661,3023,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>source<\/th>\n      <th>date<\/th>\n      <th>platform<\/th>\n      <th>metric_name<\/th>\n      <th>value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":5},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section><section id="improve-it-with-iteration" class="level2"><h2 class="anchored" data-anchor-id="improve-it-with-iteration">Improve it with iteration</h2>
<p>There’s nothing wrong with the code we’ve written above: it will work just fine. But it’s quite verbose, and doesn’t adhere to the DRY principle of software engineering: Don’t Repeat Yourself. How can we change that?</p>
<p>Well, when we look at the data prep code for each sheet we can see that the only thing that changes is the reference to a different sheet. In which case, let’s abstract the unchanging code out to our own function:</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clean_data</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sheet_name</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sheet_name</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">where</span><span class="op">(</span><span class="va">is.double</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/excel_numeric_to_date.html">excel_numeric_to_date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    metric <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html">str_to_lower</a></span><span class="op">(</span><span class="va">...1</span><span class="op">)</span>,</span>
<span>    platform <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"facebook"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Facebook"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"twitter"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Twitter"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"instagram"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Instagram"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"youtube views"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"YouTube"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"soundcloud"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Sound Cloud"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"sound cloud"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Sound Cloud"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"blog"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Blogs"</span></span>
<span>      <span class="op">)</span>,</span>
<span>    metric_cleaned <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">" \\(.*"</span>, <span class="st">""</span>, <span class="va">...1</span><span class="op">)</span>,</span>
<span>    metric_name <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"sound cloud"</span>, <span class="va">metric_cleaned</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">==</span> <span class="cn">TRUE</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"total facebook"</span>, <span class="va">metric_cleaned</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">==</span> <span class="cn">TRUE</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"^\\w+\\s\\w+\\s"</span>, <span class="st">""</span>, <span class="va">metric_cleaned</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"^\\w+\\s"</span>, <span class="st">""</span>, <span class="va">metric_cleaned</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">platform</span>, <span class="va">metric_name</span>, <span class="va">value</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">platform</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now call this function, like so:</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">excel_file</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html">dir_ls</a></span><span class="op">(</span>glob <span class="op">=</span> <span class="st">"*.xlsx"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sheet_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">excel_file</span>, range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/cellranger/man/cell_cols.html">cell_cols</a></span><span class="op">(</span><span class="st">"A:M"</span><span class="op">)</span>, sheet <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">sheet_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">excel_file</span>, range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/cellranger/man/cell_cols.html">cell_cols</a></span><span class="op">(</span><span class="st">"A:M"</span><span class="op">)</span>, sheet <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">sheet_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">excel_file</span>, range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/cellranger/man/cell_cols.html">cell_cols</a></span><span class="op">(</span><span class="st">"A:M"</span><span class="op">)</span>, sheet <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sheet_1_tidy_data</span> <span class="op">&lt;-</span> <span class="fu">clean_data</span><span class="op">(</span><span class="va">sheet_1</span><span class="op">)</span></span>
<span><span class="va">sheet_2_tidy_data</span> <span class="op">&lt;-</span> <span class="fu">clean_data</span><span class="op">(</span><span class="va">sheet_2</span><span class="op">)</span></span>
<span><span class="va">sheet_3_tidy_data</span> <span class="op">&lt;-</span> <span class="fu">clean_data</span><span class="op">(</span><span class="va">sheet_3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"FY21"</span> <span class="op">=</span> <span class="va">sheet_1_tidy_data</span>,</span>
<span>  <span class="st">"FY22"</span> <span class="op">=</span> <span class="va">sheet_2_tidy_data</span>,</span>
<span>  <span class="st">"FY23"</span> <span class="op">=</span> <span class="va">sheet_3_tidy_data</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">libraries_social_media</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  .id <span class="op">=</span> <span class="st">"year"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">libraries_social_media</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-f78de14e7309da44118b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f78de14e7309da44118b">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766","767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787","788","789","790","791","792","793","794","795","796","797","798","799","800","801","802","803","804","805","806","807","808","809","810","811","812","813","814","815","816","817","818","819","820","821","822","823","824","825","826","827","828","829","830","831","832","833","834","835","836","837","838","839","840","841","842","843","844","845","846","847","848","849","850","851","852","853","854","855","856","857","858","859","860","861","862","863","864","865","866","867","868","869","870","871","872","873","874","875","876","877","878","879","880","881","882","883","884","885","886","887","888","889","890","891","892","893","894","895","896","897","898","899","900","901","902","903","904","905","906","907","908","909","910","911","912","913","914","915","916","917","918","919","920","921","922","923","924","925","926","927","928","929","930","931","932","933","934","935","936","937","938","939","940","941","942","943","944","945","946","947","948","949","950","951","952","953","954","955","956","957","958","959","960","961","962","963","964","965","966","967","968","969","970","971","972","973","974","975","976","977","978","979","980","981","982","983","984","985","986","987","988","989","990","991","992","993","994","995","996"],["FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23"],["2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01"],["Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud"],["posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","stories","stories","stories","stories","stories","stories","stories","stories","stories","stories","stories","stories","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","views","views","views","views","views","views","views","views","views","views","views","views","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","views","views","views","views","views","views","views","views","views","views","views","views","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","views","views","views","views","views","views","views","views","views","views","views","views","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays"],[43,40,40,44,30,34,27,35,43,26,20,27,44134,85255,147762,46530,164833,91916,62554,55656,53156,33144,136521,191509,1485,0,0,0,118202,59817,45465,12114,0,0,115117,154593,1229,2303,3536,735,1446,3479,1705,2626,1447,702,4911,11010,786,1475,2443,781,4118,18719,31250,3103,1759,1193,11067,26303,11,11,14,17,10,9,10,12,10,8,8,11,19,15,28,10,17,0,7,9,15,5,12,4,20654,18204,16783,18089,121463,140396,171848,48351,14509,9379,178121,248750,0,0,0,0,49695,68662,81413,22495,0,0,70319,75299,2743,1097,1107,1168,624,579,716,754,672,522,466,912,3971,4579,5764,2480,5556,0,2262,2636,6256,1932,1918,3550,45,36,40,33,36,40,44,49,59,40,33,43,57230,50116,39250,38339,49802,40246,40643,48504,56951,47574,46410,50666,543,530,293,260,278,210,344,361,587,445,198,232,818,1161,2033,1537,1008,896,1074,1884,960,496,803,2315,11410,11536,11715,11797,11856,11925,12022,12064,12139,12220,12257,12339,9712,9769,9783,9817,9857,9904,9958,9988,10016,10057,10093,10157,10315,10344,10336,10345,10357,10337,10315,10342,10353,10354,10258,10236,213,224,214,216,220,228,226,233,242,247,251,253,11,7,10,12,5,6,7,10,14,3,6,1,29204,26532,31073,31396,30414,25191,29839,24171,35845,48054,42308,36133,59,2,2,10,6,3,9,8,5,4,7,6,11807,11648,13256,6956,5819,3806,3793,7368,9023,5662,11743,16704,5,31,16,11,5,15,4,9,11,14,4,8,2496,3194,2297,2862,2147,2169,1920,2006,2220,2190,2183,3091,7,14,18,7,11,15,14,14,40,32,35,36,11663,0,0,0,0,41933,19382,0,306951,299497,43844,193748,92265,61260,117794,70779,65275,101675,72570,45472,380828,353766,103960,267623,4730,3113,10837,4432,3213,5746,2555,2071,7622,4545,5675,5674,3800,6978,7939,14343,3608,11630,3184,1692,30096,14812,21129,780,7,11,13,7,9,14,13,8,23,23,22,25,0,5,18,8,4,5,0,17,63,19,49,29,1,5,2,1,1,0,0,0,0,0,0,0,33984,24220,19374,11177,13556,34593,17899,7781,21982,17401,12849,13158,0,931,3700,1630,1147,1834,0,5149,15854,3470,9657,4993,3555,13897,7064,1366,1307,0,0,0,0,0,0,0,14445,0,0,0,0,9524,0,0,53712,52190,0,12343,51984,39048,30138,14173,16010,46558,17899,12930,91548,73061,22506,30494,749,606,799,572,848,969,878,508,1396,1128,932,854,5609,15411,8888,2966,1764,4203,1304,0,1773,148,627,193,16,19,8,21,29,31,20,13,37,29,32,26,81561,33087,23051,18095,20030,34568,11960,6493,24152,19627,16019,12266,1462,553,868,605,667,754,333,222,703,599,778,591,138,1218,2517,1579,403,208,69,154,895,353,144,113,13746,13824,14070,14158,14247,14290,14303,14373,14424,14465,14515,14592,10203,10231,10276,10336,10384,10421,10456,10481,10523,10570,10597,10616,10255,10260,10267,10277,10301,10296,10300,10293,10295,10290,10288,10295,255,267,275,286,286,294,294,296,302,305,309,315,4,2,2,2,3,3,1,2,7,3,10,8,52479,36436,34032,50632,30718,26929,30152,27097,31254,31259,34210,40748,6,0,3,0,1,5,2,3,6,3,8,3,9724,11116,24356,8043,6974,3594,3402,6337,8871,7593,13567,19545,30,17,9,13,7,3,2,5,4,1,5,8,3835,3633,5069,3372,2940,1594,2252,2567,1609,1203,1213,1600,41,74,25,null,null,null,null,null,null,null,null,null,215914,362673,13450,null,null,null,null,null,null,null,null,null,301862,418194,48672,null,null,null,null,null,null,null,null,null,6520,13587,2831,null,null,null,null,null,null,null,null,null,672,5869,4106,null,null,null,null,null,null,null,null,null,23,31,17,null,null,null,null,null,null,null,null,null,14,60,17,null,null,null,null,null,null,null,null,null,0,2,0,null,null,null,null,null,null,null,null,null,13723,22968,12200,null,null,null,null,null,null,null,null,null,2968,3115,2534,null,null,null,null,null,null,null,null,null,0,3495,0,null,null,null,null,null,null,null,null,null,4573,0,0,null,null,null,null,null,null,null,null,null,21264,29578,14734,null,null,null,null,null,null,null,null,null,818,1315,624,null,null,null,null,null,null,null,null,null,449,4953,174,null,null,null,null,null,null,null,null,null,23,47,15,null,null,null,null,null,null,null,null,null,13258,25810,10819,null,null,null,null,null,null,null,null,null,580,1208,631,null,null,null,null,null,null,null,null,null,333,631,347,null,null,null,null,null,null,null,null,null,14627,14741,14797,null,null,null,null,null,null,null,null,null,10625,10680,10688,null,null,null,null,null,null,null,null,null,10296,10311,10312,null,null,null,null,null,null,null,null,null,320,326,328,null,null,null,null,null,null,null,null,null,5,7,1,null,null,null,null,null,null,null,null,null,32430,33277,28643,null,null,null,null,null,null,null,null,null,0,7,5,null,null,null,null,null,null,null,null,null,8782,10591,12531,null,null,null,null,null,null,null,null,null,3,9,3,null,null,null,null,null,null,null,null,null,1919,1661,3023,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>year<\/th>\n      <th>date<\/th>\n      <th>platform<\/th>\n      <th>metric_name<\/th>\n      <th>value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":5},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>This is all well and good, but we’re still repeating ourselves! Let’s bring in the magic of purrr to loop over each sheet and pass the contents to our newly-created clean_names function…</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># install.packages("purrr")</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/">purrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># declare the data-cleaning function</span></span>
<span><span class="va">clean_data</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sheet_name</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sheet_name</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">where</span><span class="op">(</span><span class="va">is.double</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/excel_numeric_to_date.html">excel_numeric_to_date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    metric <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html">str_to_lower</a></span><span class="op">(</span><span class="va">...1</span><span class="op">)</span>,</span>
<span>    platform <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"facebook"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Facebook"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"twitter"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Twitter"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"instagram"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Instagram"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"youtube views"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"YouTube"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"soundcloud"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Sound Cloud"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"sound cloud"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Sound Cloud"</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric</span>, <span class="st">"blog"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Blogs"</span></span>
<span>      <span class="op">)</span>,</span>
<span>    metric_cleaned <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">" \\(.*"</span>, <span class="st">""</span>, <span class="va">...1</span><span class="op">)</span>,</span>
<span>    metric_name <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"sound cloud"</span>, <span class="va">metric_cleaned</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">==</span> <span class="cn">TRUE</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"total facebook"</span>, <span class="va">metric_cleaned</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">==</span> <span class="cn">TRUE</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"^\\w+\\s\\w+\\s"</span>, <span class="st">""</span>, <span class="va">metric_cleaned</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"^\\w+\\s"</span>, <span class="st">""</span>, <span class="va">metric_cleaned</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">platform</span>, <span class="va">metric_name</span>, <span class="va">value</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">platform</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># get each of the Excel sheets in a list format</span></span>
<span><span class="va">excel_file</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html">dir_ls</a></span><span class="op">(</span>glob <span class="op">=</span> <span class="st">"*.xlsx"</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span></span>
<span>  .x <span class="op">=</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/excel_sheets.html">excel_sheets</a></span><span class="op">(</span><span class="va">excel_file</span><span class="op">)</span>,</span>
<span>  .f <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">excel_file</span>, sheet <span class="op">=</span> <span class="va">.x</span>, range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/cellranger/man/cell_cols.html">cell_cols</a></span><span class="op">(</span><span class="st">"A:M"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># give each list item a name based on the Financial Year so we can add it as a column</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FY21"</span>, <span class="st">"FY22"</span>, <span class="st">"FY23"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># pass each of the list items through our function</span></span>
<span><span class="va">tidy_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dfr</a></span><span class="op">(</span></span>
<span>  .x <span class="op">=</span> <span class="va">data</span>,</span>
<span>  .f <span class="op">=</span> <span class="va">clean_data</span>,</span>
<span>  .id <span class="op">=</span> <span class="st">"year"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">tidy_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-cc0abb0c1c1a9860589c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-cc0abb0c1c1a9860589c">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766","767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787","788","789","790","791","792","793","794","795","796","797","798","799","800","801","802","803","804","805","806","807","808","809","810","811","812","813","814","815","816","817","818","819","820","821","822","823","824","825","826","827","828","829","830","831","832","833","834","835","836","837","838","839","840","841","842","843","844","845","846","847","848","849","850","851","852","853","854","855","856","857","858","859","860","861","862","863","864","865","866","867","868","869","870","871","872","873","874","875","876","877","878","879","880","881","882","883","884","885","886","887","888","889","890","891","892","893","894","895","896","897","898","899","900","901","902","903","904","905","906","907","908","909","910","911","912","913","914","915","916","917","918","919","920","921","922","923","924","925","926","927","928","929","930","931","932","933","934","935","936","937","938","939","940","941","942","943","944","945","946","947","948","949","950","951","952","953","954","955","956","957","958","959","960","961","962","963","964","965","966","967","968","969","970","971","972","973","974","975","976","977","978","979","980","981","982","983","984","985","986","987","988","989","990","991","992","993","994","995","996"],["FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23"],["2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01"],["Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud"],["posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","stories","stories","stories","stories","stories","stories","stories","stories","stories","stories","stories","stories","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","views","views","views","views","views","views","views","views","views","views","views","views","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","views","views","views","views","views","views","views","views","views","views","views","views","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","paid reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","reach","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Newsfeed posts","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Stories","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Reels","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Newsfeed Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Stories Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Reels Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Paid Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Reach","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","Instagram Engagement","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","impressions","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","video views","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","followers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","subscribers","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","posts","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","comments","views","views","views","views","views","views","views","views","views","views","views","views","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcasts","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays","podcast plays"],[43,40,40,44,30,34,27,35,43,26,20,27,44134,85255,147762,46530,164833,91916,62554,55656,53156,33144,136521,191509,1485,0,0,0,118202,59817,45465,12114,0,0,115117,154593,1229,2303,3536,735,1446,3479,1705,2626,1447,702,4911,11010,786,1475,2443,781,4118,18719,31250,3103,1759,1193,11067,26303,11,11,14,17,10,9,10,12,10,8,8,11,19,15,28,10,17,0,7,9,15,5,12,4,20654,18204,16783,18089,121463,140396,171848,48351,14509,9379,178121,248750,0,0,0,0,49695,68662,81413,22495,0,0,70319,75299,2743,1097,1107,1168,624,579,716,754,672,522,466,912,3971,4579,5764,2480,5556,0,2262,2636,6256,1932,1918,3550,45,36,40,33,36,40,44,49,59,40,33,43,57230,50116,39250,38339,49802,40246,40643,48504,56951,47574,46410,50666,543,530,293,260,278,210,344,361,587,445,198,232,818,1161,2033,1537,1008,896,1074,1884,960,496,803,2315,11410,11536,11715,11797,11856,11925,12022,12064,12139,12220,12257,12339,9712,9769,9783,9817,9857,9904,9958,9988,10016,10057,10093,10157,10315,10344,10336,10345,10357,10337,10315,10342,10353,10354,10258,10236,213,224,214,216,220,228,226,233,242,247,251,253,11,7,10,12,5,6,7,10,14,3,6,1,29204,26532,31073,31396,30414,25191,29839,24171,35845,48054,42308,36133,59,2,2,10,6,3,9,8,5,4,7,6,11807,11648,13256,6956,5819,3806,3793,7368,9023,5662,11743,16704,5,31,16,11,5,15,4,9,11,14,4,8,2496,3194,2297,2862,2147,2169,1920,2006,2220,2190,2183,3091,7,14,18,7,11,15,14,14,40,32,35,36,11663,0,0,0,0,41933,19382,0,306951,299497,43844,193748,92265,61260,117794,70779,65275,101675,72570,45472,380828,353766,103960,267623,4730,3113,10837,4432,3213,5746,2555,2071,7622,4545,5675,5674,3800,6978,7939,14343,3608,11630,3184,1692,30096,14812,21129,780,7,11,13,7,9,14,13,8,23,23,22,25,0,5,18,8,4,5,0,17,63,19,49,29,1,5,2,1,1,0,0,0,0,0,0,0,33984,24220,19374,11177,13556,34593,17899,7781,21982,17401,12849,13158,0,931,3700,1630,1147,1834,0,5149,15854,3470,9657,4993,3555,13897,7064,1366,1307,0,0,0,0,0,0,0,14445,0,0,0,0,9524,0,0,53712,52190,0,12343,51984,39048,30138,14173,16010,46558,17899,12930,91548,73061,22506,30494,749,606,799,572,848,969,878,508,1396,1128,932,854,5609,15411,8888,2966,1764,4203,1304,0,1773,148,627,193,16,19,8,21,29,31,20,13,37,29,32,26,81561,33087,23051,18095,20030,34568,11960,6493,24152,19627,16019,12266,1462,553,868,605,667,754,333,222,703,599,778,591,138,1218,2517,1579,403,208,69,154,895,353,144,113,13746,13824,14070,14158,14247,14290,14303,14373,14424,14465,14515,14592,10203,10231,10276,10336,10384,10421,10456,10481,10523,10570,10597,10616,10255,10260,10267,10277,10301,10296,10300,10293,10295,10290,10288,10295,255,267,275,286,286,294,294,296,302,305,309,315,4,2,2,2,3,3,1,2,7,3,10,8,52479,36436,34032,50632,30718,26929,30152,27097,31254,31259,34210,40748,6,0,3,0,1,5,2,3,6,3,8,3,9724,11116,24356,8043,6974,3594,3402,6337,8871,7593,13567,19545,30,17,9,13,7,3,2,5,4,1,5,8,3835,3633,5069,3372,2940,1594,2252,2567,1609,1203,1213,1600,41,74,25,null,null,null,null,null,null,null,null,null,215914,362673,13450,null,null,null,null,null,null,null,null,null,301862,418194,48672,null,null,null,null,null,null,null,null,null,6520,13587,2831,null,null,null,null,null,null,null,null,null,672,5869,4106,null,null,null,null,null,null,null,null,null,23,31,17,null,null,null,null,null,null,null,null,null,14,60,17,null,null,null,null,null,null,null,null,null,0,2,0,null,null,null,null,null,null,null,null,null,13723,22968,12200,null,null,null,null,null,null,null,null,null,2968,3115,2534,null,null,null,null,null,null,null,null,null,0,3495,0,null,null,null,null,null,null,null,null,null,4573,0,0,null,null,null,null,null,null,null,null,null,21264,29578,14734,null,null,null,null,null,null,null,null,null,818,1315,624,null,null,null,null,null,null,null,null,null,449,4953,174,null,null,null,null,null,null,null,null,null,23,47,15,null,null,null,null,null,null,null,null,null,13258,25810,10819,null,null,null,null,null,null,null,null,null,580,1208,631,null,null,null,null,null,null,null,null,null,333,631,347,null,null,null,null,null,null,null,null,null,14627,14741,14797,null,null,null,null,null,null,null,null,null,10625,10680,10688,null,null,null,null,null,null,null,null,null,10296,10311,10312,null,null,null,null,null,null,null,null,null,320,326,328,null,null,null,null,null,null,null,null,null,5,7,1,null,null,null,null,null,null,null,null,null,32430,33277,28643,null,null,null,null,null,null,null,null,null,0,7,5,null,null,null,null,null,null,null,null,null,8782,10591,12531,null,null,null,null,null,null,null,null,null,3,9,3,null,null,null,null,null,null,null,null,null,1919,1661,3023,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>year<\/th>\n      <th>date<\/th>\n      <th>platform<\/th>\n      <th>metric_name<\/th>\n      <th>value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":5},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>And there you have it, a lean script for cleaning the data in each of the sheets from the Excel file. If more sheets are added, and assuming they follow the same basic structure as the other three, this script will work just fine on those too. And there’s no repetition here, which means the code is easier to read (and easier to describe: see how simple my comments are above each section of the code?), and easier to maintain.</p>
</section><section id="whats-the-most-least-popular-social-media-platform" class="level2"><h2 class="anchored" data-anchor-id="whats-the-most-least-popular-social-media-platform">What’s the most &amp; least popular social media platform?</h2>
<p>Now we’re ready to answer the question: was Facebook, Twitter, or Instagram the most popular social media platform across this period?</p>
<p>As we’ve already prepared columns for platform and metric_name, it’s fairly simple to filter down to the rows we need:</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">social_engagement</span> <span class="op">&lt;-</span> <span class="va">tidy_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">platform</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Facebook"</span>, <span class="st">"Twitter"</span>, <span class="st">"Instagram"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric_name</span>, <span class="st">"engagement"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">social_engagement</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-80f4dbd9141cae9ae89e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-80f4dbd9141cae9ae89e">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84"],["FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23"],["2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01"],["Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Instagram","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Facebook","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter","Twitter"],["engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagement","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements","engagements"],[1229,2303,3536,735,1446,3479,1705,2626,1447,702,4911,11010,2743,1097,1107,1168,624,579,716,754,672,522,466,912,543,530,293,260,278,210,344,361,587,445,198,232,4730,3113,10837,4432,3213,5746,2555,2071,7622,4545,5675,5674,1462,553,868,605,667,754,333,222,703,599,778,591,6520,13587,2831,null,null,null,null,null,null,null,null,null,580,1208,631,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>year<\/th>\n      <th>date<\/th>\n      <th>platform<\/th>\n      <th>metric_name<\/th>\n      <th>value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":5},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>So, which was the most popular across this period? Let’s find out!</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">social_engagement</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">platform</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>total_engagement <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">total_engagement</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  platform  total_engagement
  &lt;chr&gt;                &lt;dbl&gt;
1 Facebook            118280
2 Twitter              14835
3 Instagram            11360</code></pre>
</div>
</div>
<p>This three-row tibble sorts the social media platforms in descending order according to the total engagement across the entire period; notice I passed na.rm = TRUE to summarise() to disregard any missing values in the calculation, otherwise it would just return NA.</p>
<p>From this simple table, I can see that on top is Facebook, and on the bottom is Twitter.</p>
</section><section id="what-are-the-peak-months-for-each-platform" class="level2"><h2 class="anchored" data-anchor-id="what-are-the-peak-months-for-each-platform">What are the “peak” months for each platform?</h2>
<p>While we have these engagement metrics for each social media platform, let’s grab the “peak” month for each as well.</p>
<p>To do this, we create a new column that gives us the peak value for each platform. Then we convert that column to a binary by comparing each “peak” value against each’s month’s value. Finally, we filter to only the peak values and select the columns we need.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">peak_social_engagement</span> <span class="op">&lt;-</span> <span class="va">social_engagement</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">platform</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>peak_engagement <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>peak_engagement <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">value</span> <span class="op">==</span> <span class="va">peak_engagement</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">peak_engagement</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">platform</span>, <span class="va">date</span>, <span class="va">value</span><span class="op">)</span></span>
<span></span>
<span><span class="va">peak_social_engagement</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  platform  date       value
  &lt;chr&gt;     &lt;date&gt;     &lt;dbl&gt;
1 Instagram 2020-07-01  2743
2 Twitter   2021-07-01  1462
3 Facebook  2022-08-01 13587</code></pre>
</div>
</div>
<div class="cell">

</div>
<p>And there we have it: Instagram peaked at 2,743 engagements in July 2020, Twitter peaked at 1,462 engagements in July 2021, and Facebook peaked at 13,587 engagements in August 2022.</p>
<p>Although we’ve found the “peak” months for Facebook, Twitter, and Instagram, let’s also do the same for YouTube, blogs, and Sound Cloud.</p>
<p>Let’s pull out the unique metric names per platform per Financial Year to get a sense of what we need to search for:</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tidy_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">platform</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sound Cloud"</span>, <span class="st">"Blogs"</span>, <span class="st">"YouTube"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">platform</span>, <span class="va">metric_name</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-9ed92e39ca5ac996a405" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-9ed92e39ca5ac996a405">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21"],["FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY23","FY23","FY23","FY23","FY23","FY23","FY23"],["Sound Cloud","Blogs","Blogs","Blogs","YouTube","Sound Cloud","Sound Cloud","Sound Cloud","Blogs","Blogs","Blogs","YouTube","Sound Cloud","Sound Cloud","Sound Cloud","Blogs","Blogs","Blogs","YouTube","Sound Cloud","Sound Cloud"],["subscribers","posts","page views","comments","views","podcasts","podcast listens","subscribers","posts","page views","comments","views","podcasts","podcast listens","subscribers","posts","page views","comments","views","podcasts","podcast plays"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>year<\/th>\n      <th>platform<\/th>\n      <th>metric_name<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Scrolling through this table, we can see that for blogs we need to search for “page views”, for YouTube it’s “views”, ans for Sound Cloud it’s “podcast listens”… except in FY23, when it’s “podcast plays”. Armed with this knowledge, let’s find what we need by passing a unique pattern for str_detect where were separate each value with a vertical line (read it as “or”)…</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">other_engagement</span> <span class="op">&lt;-</span> <span class="va">tidy_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">platform</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Blogs"</span>, <span class="st">"YouTube"</span>, <span class="st">"Sound Cloud"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">metric_name</span>, <span class="st">"page views|views|podcast listens|podcast plays"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">other_engagement</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-9972a2967aa0af36115f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-9972a2967aa0af36115f">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81"],["FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY21","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY22","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23","FY23"],["2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-07-01","2022-08-01","2022-09-01","2022-07-01","2022-08-01","2022-09-01"],["Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","Blogs","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","YouTube","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Sound Cloud","Blogs","Blogs","Blogs","YouTube","YouTube","YouTube","Sound Cloud","Sound Cloud","Sound Cloud"],["page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","views","views","views","views","views","views","views","views","views","views","views","views","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","page views","views","views","views","views","views","views","views","views","views","views","views","views","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","podcast listens","page views","page views","page views","views","views","views","podcast plays","podcast plays","podcast plays"],[29204,26532,31073,31396,30414,25191,29839,24171,35845,48054,42308,36133,11807,11648,13256,6956,5819,3806,3793,7368,9023,5662,11743,16704,2496,3194,2297,2862,2147,2169,1920,2006,2220,2190,2183,3091,52479,36436,34032,50632,30718,26929,30152,27097,31254,31259,34210,40748,9724,11116,24356,8043,6974,3594,3402,6337,8871,7593,13567,19545,3835,3633,5069,3372,2940,1594,2252,2567,1609,1203,1213,1600,32430,33277,28643,8782,10591,12531,1919,1661,3023]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>year<\/th>\n      <th>date<\/th>\n      <th>platform<\/th>\n      <th>metric_name<\/th>\n      <th>value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":5},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>This looks like the data we need! Let’s once again grab the “peak” months for each…</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">other_peak_social_engagement</span> <span class="op">&lt;-</span> <span class="va">other_engagement</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">platform</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>peak_engagement <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>peak_engagement <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">value</span> <span class="op">==</span> <span class="va">peak_engagement</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">peak_engagement</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">platform</span>, <span class="va">date</span>, <span class="va">value</span><span class="op">)</span></span>
<span></span>
<span><span class="va">other_peak_social_engagement</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  platform    date       value
  &lt;chr&gt;       &lt;date&gt;     &lt;dbl&gt;
1 Blogs       2021-07-01 52479
2 YouTube     2021-09-01 24356
3 Sound Cloud 2021-09-01  5069</code></pre>
</div>
</div>
<div class="cell">

</div>
<p>And there we have it: Sound Cloud peaked at 5,069 engagements in September 2021, the blogs peaked at 52,479 engagements in July 2021, and YouTube peaked at 24,356 engagements in September 2021.</p>
<p>And we’re done here… or are we? Maybe we’re repeating ourselves with this analysis, and we can abstract this into a function to call with purrr again… but I’ll leave that one to you to figure out :-)</p>
</section></main><!-- /main column --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>